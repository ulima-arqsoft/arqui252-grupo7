> [5. Tácticas](../5.md) › [5.1. Módulo 1 / Integrante 1](5.1.md)

# 5.1. Módulo 1 / Integrante 1

# **Tácticas aplicables al Módulo de Gestión de Compras**

A continuación se detallan los escenarios seleccionados del módulo de Gestión de Compras junto con las tácticas arquitectónicas aplicables.  
Cada escenario incluye alternativas evaluadas, táctica(s) elegida(s), contexto y sustento técnico.

---

## **Escenario 1 — Pico de checkout sin caídas**

| **Cod Escenario** | **Atributo de Calidad** | **Estímulo** | **Fuente del Estímulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|--------------------|--------------------------|---------------|---------------------------|----------------|---------------|-----------------------------|------------------------------|
| ESC-GC-01 | Disponibilidad / Rendimiento | Pico de 800–1200 checkouts concurrentes | Usuarios finales | Backend de Checkout + API Gateway | Campaña “flash sale” | El servicio se mantiene estable y responde sin timeouts | p95 < 700 ms, uptime ≥ 99.9% durante el evento |

**Aplica técnicas (alternativas):**
- Redundancia activa (N+1) con balanceo L7  
- Autoescalado horizontal (HPA/KEDA) + límites de concurrencia  
- Caché de lectura (catálogo/precios) + CDN  
- Pooling de conexiones a BD + circuitos por dependencia  

**Táctica(s) elegida(s):**  
Redundancia activa (N+1) + Autoescalado horizontal + Caché de lectura.

**Contexto:**  
El checkout es el cuello de botella del negocio en campañas de alto tráfico.

**Criterios de elección:**  
Estabilidad bajo carga, latencia p95, costo controlado, mínima intrusión en el código.

**Decisión y sustento:**  
N+1 garantiza tolerancia a fallos; HPA absorbe picos efímeros; caché reduce I/O a BD y mantiene p95 < 700 ms sin sobreprovisionar.

---

## **Escenario 2 — Caída o lentitud de la pasarela de pagos**

| **Cod Escenario** | **Atributo de Calidad** | **Estímulo** | **Fuente del Estímulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|--------------------|--------------------------|---------------|---------------------------|----------------|---------------|-----------------------------|------------------------------|
| ESC-GC-02 | Confiabilidad / Resiliencia | Timeout o error 5xx al cobrar | Pasarela de pagos externa | Servicio de Pagos | Horario pico | El sistema aísla la falla, encola y reintenta sin bloquear el checkout | Tasa de éxito ≥ 99% con reintentos; fallbacks < 1 min |

**Aplica técnicas (alternativas):**
- Circuit Breaker + Exponential Backoff  
- Outbox/Transactional Outbox + cola de reintentos  
- Fallback “pago pendiente” (post-confirmación) + reconciliación  
- Multi-proveedor (routing activo/pasivo)

**Táctica(s) elegida(s):**  
Circuit Breaker + Outbox con reintentos + Fallback “pago pendiente”.

**Contexto:**  
Dependencia externa no controlada; se busca evitar efecto dominó en checkout.

**Criterios de elección:**  
Aislamiento de fallas, garantía de entrega, idempotencia, experiencia de usuario.

**Decisión y sustento:**  
El breaker evita saturar la pasarela; outbox asegura entrega eventual sin perder transacciones; fallback preserva la venta y permite reconciliar sin bloquear al cliente.

---

## **Escenario 3 — Doble cobro o pedido duplicado por reintentos**

| **Cod Escenario** | **Atributo de Calidad** | **Estímulo** | **Fuente del Estímulo** | **Artefacto** | **Entorno** | **Respuesta** | **Medida de Respuesta** |
|--------------------|--------------------------|---------------|---------------------------|----------------|---------------|-----------------------------|------------------------------|
| ESC-GC-03 | Consistencia / Integridad | Reintento automático y refresh del usuario | Cliente + lógica de reintentos | Servicio de Checkout + BD | Red intermitente | Se evita duplicar pedidos y cargos | 0% de pedidos duplicados; unicidad garantizada |

**Aplica técnicas (alternativas):**
- Idempotency Key por operación de cobro/orden  
- Unique Constraints en BD (order_id, payment_intent)  
- Transactional Outbox + Exactly-once by design  
- Optimistic Locking para concurrencia

**Táctica(s) elegida(s):**  
Idempotency Keys + Unique Constraints + Outbox.

**Contexto:**  
Los reintentos son necesarios pero deben ser seguros y sin duplicación.

**Criterios de elección:**  
Simplicidad operacional, garantías fuertes de unicidad, auditoría.

**Decisión y sustento:**  
La idempotencia en capa de API y la unicidad en BD eliminan duplicados; outbox evita dobles efectos en eventos downstream.
