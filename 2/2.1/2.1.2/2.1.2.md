# 2.1.2. Módulo 1 - Autenticación y Usuarios

Este módulo se encarga de gestionar el acceso seguro al sistema y sus APIs, permitiendo el registro e inicio de sesión de usuarios, administración de roles y permisos, validación de tokens y recuperación de credenciales. Además, asegura que solo usuarios autorizados puedan acceder a los recursos, protegiendo la integridad y confidencialidad de la información.  

---

## Requisitos Funcionales

- El sistema debe permitir el **registro de usuarios** validando la unicidad del correo electrónico.  
- El sistema debe permitir el **inicio de sesión seguro** mediante credenciales y emitir un **token de acceso (JWT u OAuth2)**.  
- El sistema debe implementar un **mecanismo de refresco de tokens** para renovar sesiones sin necesidad de reingreso de credenciales.  
- El sistema debe permitir la **recuperación de contraseña** mediante el envío de un correo electrónico seguro.  
- El sistema debe gestionar **roles y permisos** para diferenciar accesos de usuarios y administradores.  
- El sistema debe **validar tokens en cada petición** realizada a las APIs protegidas.  
- El sistema debe registrar en **logs de auditoría** todos los intentos de inicio de sesión (exitosos y fallidos).  
- El sistema debe permitir la **revocación de tokens** en caso de incidentes de seguridad.  
- El sistema debe ofrecer soporte para **autenticación multifactor (MFA)** como medida adicional de seguridad.  

---

## Requisitos de Atributos de Calidad

| **Atributo de Calidad** | **Estímulo**                                      | **Fuente del Estímulo** | **Artefacto**               | **Entorno**             | **Respuesta**                                               | **Medida de Respuesta**                      |
|--------------------------|--------------------------------------------------|--------------------------|-----------------------------|--------------------------|------------------------------------------------------------|---------------------------------------------|
| **Seguridad**            | Usuario malicioso intenta acceder con token inválido | Usuario malicioso        | API de autenticación        | Operación normal         | El sistema rechaza la petición y registra el intento        | 100% de intentos inválidos generan error 401 en < 1s |
| **Seguridad**            | Ataque de fuerza bruta con múltiples intentos fallidos | Atacante externo         | Endpoint `/login`           | Alta frecuencia de peticiones | El sistema bloquea la cuenta o IP tras 5 intentos fallidos | Bloqueo aplicado en < 2s desde el 5° intento |
| **Disponibilidad**       | Falla del servidor de autenticación               | Servidor en la nube      | Servicio de login/refresh   | Horario laboral          | El sistema redirige la operación a un servidor en standby   | Disponibilidad ≥ 99.9% anual                 |
| **Rendimiento**          | 1000 usuarios intentan iniciar sesión en simultáneo | Usuarios legítimos       | Endpoint `/login`           | Hora pico               | El sistema procesa concurrentemente las solicitudes        | Tiempo de respuesta ≤ 2 segundos             |
| **Usabilidad**           | Usuario olvida su contraseña                      | Usuario registrado       | API de recuperación         | Operación normal         | El sistema envía enlace de recuperación al correo registrado | Email enviado en < 1 minuto                  |
| **Mantenibilidad**       | Cambio en la política de expiración de tokens     | Equipo de seguridad      | Servicio de autenticación   | Producción               | Se modifica parámetro de configuración sin afectar código   | Implementación en < 1 hora                   |

---

## Restricciones

- El módulo de Autenticación deberá implementarse utilizando **OAuth2.0 con JWT**, de acuerdo con los estándares de seguridad de la organización.  
- Todo el tráfico entre clientes y el servidor deberá realizarse bajo **HTTPS (TLS 1.2 o superior)**.  
- El almacenamiento de contraseñas deberá hacerse utilizando algoritmos de hashing seguros como **Argon2 o bcrypt con salt**.  
- El módulo deberá desarrollarse en **Node.js con PostgreSQL**, siguiendo el stack corporativo.  
- El sistema deberá integrarse con la plataforma de **monitoreo y auditoría centralizada** de la organización.
