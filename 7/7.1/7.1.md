> [7. Estructura Inicial de CÃ³digo](../7.md) â€º [7.1. CatÃ¡logo de Aplicaciones](7.1.md)

# 7.1. CatÃ¡logo de Aplicaciones

### 7.1.1. iOS (Swift) â€” Clean Architecture

La aplicaciÃ³n mÃ³vil para iOS estÃ¡ desarrollada en **Swift**, utilizando **SwiftUI** y **Combine**, bajo el patrÃ³n **Clean Architecture**.  
Este enfoque permite mantener un bajo acoplamiento entre capas, independencia de frameworks y alta testabilidad, siguiendo la direcciÃ³n de dependencias **Presentation â†’ Domain â†’ Data**.

**AplicaciÃ³n** | **Contenedor** | **TecnologÃ­a FE** | **TecnologÃ­a BE** | **BD (local)** | **Repositorio/Carpeta**
---|---|---|---|---|---
App iOS cliente | Mobile (iOS) | SwiftUI, Combine, MVVM | .NET API C# (REST) | UserDefaults / CoreData | `/ios/Loop`

> Estructura general del proyecto en Xcode:  
> ![swift_loop_app](images/swift_loop_app.png)

---

#### Estructura de carpetas

- `Loop/App/Data/` â€” fuentes de datos, implementaciÃ³n de repositorios.  
- `Loop/App/Data/Datasources/` â€” acceso remoto (API REST) o local (UserDefaults, CoreData).  
- `Loop/App/Data/Repositories/` â€” implementaciÃ³n concreta de interfaces del dominio.  

- `Loop/App/Domain/` â€” entidades, errores y casos de uso del negocio (agnÃ³sticos de framework).  
- `Loop/App/Domain/Models/` â€” modelos de dominio como `Cart`, `Product`, `User`.  
- `Loop/App/Domain/UseCases/` â€” casos de uso principales: agregar producto, eliminar item, sincronizar carrito.  

- `Loop/App/Infrastructure/` â€” capa tÃ©cnica: red, persistencia y servicios auxiliares.  
- `Loop/App/Infrastructure/Networking/` â€” cliente HTTP con `URLSession`, autenticaciÃ³n JWT, manejo de errores.  
- `Loop/App/Infrastructure/UserDefaults/` â€” almacenamiento ligero de preferencias y carrito invitado.  

- `Loop/App/Presentation/` â€” capa de presentaciÃ³n (UI + ViewModels).  
- `Loop/App/Presentation/Scenes/` â€” vistas y pantallas (SwiftUI) organizadas por mÃ³dulo:  
  - `Cart/` â€” gestiÃ³n del carrito (RF-GC-01, RF-GC-02).  
  - `Explore/` â€” catÃ¡logo de productos.  
  - `Product/` â€” detalle de producto.  
  - `Profile/` â€” perfil e historial de compras (RF-GC-09).  
  - `TabView/` â€” navegaciÃ³n principal.  
- `Loop/App/Presentation/Shared/` â€” componentes visuales reutilizables (botones, headers, estilos).

- `Loop/App/SupportingFiles/` â€” recursos, assets, configuraciones.  
- `Loop/App/Info/` â€” metadatos del proyecto (`Info.plist`).  
- `AppDelegate.swift` / `LoopApp.swift` â€” punto de entrada y configuraciÃ³n inicial del entorno.

---

#### Decisiones tÃ©cnicas principales

- **Arquitectura:** Clean Architecture + MVVM (separaciÃ³n estricta de UI, dominio y datos).  
- **Estado global:** `@StateObject` + `ObservableObject` para reactividad y sincronizaciÃ³n con backend.  
- **Networking:** `URLSession` con `async/await`, encabezados `Authorization` (JWT) y `X-Request-Id`.  
- **Persistencia:** `UserDefaults` para carrito local; `CoreData` opcional para cachear catÃ¡logo y precios.  
- **Casos de uso:** definidos en *Domain*, independientes de frameworks, probados con `XCTest`.  
- **Accesibilidad:** compatibilidad con *VoiceOver* y *Dynamic Type*.  
- **IntegraciÃ³n backend:** consumo de endpoints `/carts`, `/checkout`, `/orders` del backend .NET + PostgreSQL.

---

#### Ejemplo de correspondencia conceptual

| Capa | FunciÃ³n | Ejemplo |
|------|----------|----------|
| **Data** | Fuente de datos (repositorios, API, almacenamiento) | `CartRepository.swift`, `CartRemoteDataSource.swift` |
| **Domain** | LÃ³gica de negocio, entidades y casos de uso | `AddProductUseCase.swift`, `Cart.swift` |
| **Infrastructure** | Servicios de soporte tÃ©cnico | `NetworkClient.swift`, `UserDefaultsService.swift` |
| **Presentation** | UI y ViewModels | `CartView.swift`, `CartViewModel.swift` |

---

> En conjunto, esta arquitectura garantiza independencia del framework, soporte offline-first y sincronizaciÃ³n confiable del carrito, alineada con los requisitos funcionales y no funcionales del *Ecommerce de Ropa*.

---
### 7.1.2. Backend (.NET) â€” Clean Architecture

El backend del sistema **Loop** estÃ¡ desarrollado en **.NET 8 (C#)**, aplicando los principios de **Clean Architecture** y una organizaciÃ³n modular orientada a capas, garantizando separaciÃ³n de responsabilidades, mantenibilidad y testabilidad.  

La estructura general sigue el flujo de dependencias:  
**Controllers â†’ Services â†’ Data/Models â†’ Database (PostgreSQL)**.

**AplicaciÃ³n** | **Contenedor** | **TecnologÃ­a FE** | **TecnologÃ­a BE** | **Base de Datos** | **Repositorio/Carpeta**
---|---|---|---|---|---
API REST .NET | Backend | â€” | ASP.NET Core 8 (C#), EF Core | PostgreSQL | `/Loop`

> Estructura general del proyecto en Visual Studio Code:  
> ![dotnet_loop_app](images/dotnet_loop_app.png)

---

#### Estructura de carpetas

- `Controllers/` â€” controladores principales de la API.  
  Contienen los endpoints REST que exponen la lÃ³gica del dominio.  
  Ejemplo: `StoriesController.cs`, `AuthController.cs`.

- `Data/` â€” capa de acceso a datos.  
  Define el contexto de base de datos (`DbContext`) y configuraciones de entidades.  
  Ejemplo: `AppDbContext.cs`, `DbInitializer.cs`.

- `Models/` â€” modelos de dominio y entidades persistentes.  
  Representan tablas de la base de datos y estructuras de negocio.  
  Ejemplo: `Story.cs`, `Category.cs`, `Language.cs`.

- `DTOs/` â€” objetos de transferencia de datos.  
  Facilitan la comunicaciÃ³n entre la capa de presentaciÃ³n y los modelos.  
  Ejemplo: `StoryDTO.cs`, `CategoryDTO.cs`.

- `Services/` â€” capa de lÃ³gica de negocio y casos de uso.  
  Implementa las operaciones principales del dominio (creaciÃ³n, filtrado, validaciÃ³n, subida de archivos).  
  Ejemplo: `StoryService.cs`, `CloudinaryService.cs`.

- `Documentation/` â€” especificaciones y descripciones de la API.  
  Puede incluir archivos de referencia para Swagger u OpenAPI.

- `logs/` â€” registro de eventos, errores y auditorÃ­as del sistema.

- `Properties/`, `obj/` â€” archivos de configuraciÃ³n y metadatos del proyecto.

- `appsettings.json` / `appsettings.Development.json` â€” configuraciÃ³n de entorno (cadena de conexiÃ³n, JWT, Cloudinary, etc.).

- `.env` â€” variables de entorno sensibles (claves secretas, rutas de conexiÃ³n).

- `Dockerfile` / `docker-compose.yml` â€” configuraciÃ³n de despliegue en contenedores Docker.  
  Define la imagen base .NET, el servicio PostgreSQL y la red de la aplicaciÃ³n.

- `run_docker.py` â€” script auxiliar en Python para automatizar la construcciÃ³n y ejecuciÃ³n del contenedor.

- `Program.cs` â€” punto de entrada principal de la aplicaciÃ³n.  
  Configura los servicios, dependencias y middlewares (autenticaciÃ³n, CORS, Swagger, EF Core).

- `Loop.csproj` â€” archivo de configuraciÃ³n del proyecto .NET, dependencias y metadatos.

---

#### Decisiones tÃ©cnicas principales

- **Arquitectura:** Clean Architecture + Repository-Service Pattern.  
- **Framework:** ASP.NET Core 8 con Entity Framework Core.  
- **Persistencia:** PostgreSQL, con migraciones automÃ¡ticas mediante `dotnet ef`.  
- **InyecciÃ³n de dependencias:** nativa de .NET (`IServiceCollection`).  
- **AutenticaciÃ³n y seguridad:** JWT Bearer + validaciÃ³n de roles.  
- **DocumentaciÃ³n:** Swagger UI / OpenAPI.  
- **Despliegue:** Docker + `docker-compose` con servicio de base de datos y red interna.  
- **Manejo de logs:** IntegraciÃ³n con `ILogger` y almacenamiento en `logs/`.  
- **ConfiguraciÃ³n dinÃ¡mica:** `appsettings.*.json` y variables `.env`.  

---

#### Ejemplo de correspondencia conceptual

| Capa | FunciÃ³n | Ejemplo |
|------|----------|----------|
| **Controllers** | ExposiciÃ³n de endpoints REST | `StoriesController.cs`, `AuthController.cs` |
| **Services** | LÃ³gica de negocio y validaciones | `StoryService.cs`, `CloudinaryService.cs` |
| **Data** | Contexto y acceso a base de datos | `AppDbContext.cs`, `DbInitializer.cs` |
| **Models** | Entidades del dominio | `Story.cs`, `Category.cs` |
| **DTOs** | Transferencia de datos entre capas | `StoryDTO.cs`, `CategoryDTO.cs` |

---

> En conjunto, esta arquitectura garantiza independencia de frameworks, una separaciÃ³n clara de responsabilidades y una fÃ¡cil integraciÃ³n con los clientes mÃ³viles (iOS y Android), manteniendo la coherencia con el enfoque Clean Architecture adoptado en todo el ecosistema *Loop*.

---

### 7.1.3. Android (Kotlin) â€” Clean Architecture

[ğŸ  Home](../../README.md) | [Siguiente â¡ï¸](../7.2/7.2.md)